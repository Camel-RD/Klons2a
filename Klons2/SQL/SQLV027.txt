SET TERM ^ ;

ALTER PROCEDURE SP_PARAMS(
  USERNAME VARCHAR(20))
RETURNS (
  ID /* TYPE OF COLUMN PARAMS.ID */ INTEGER,
  PNAME /* TYPE OF COLUMN PARAMS.PNAME */ VARCHAR(20),
  PVALUE /* TYPE OF COLUMN PARAMS.PVALUE */ VARCHAR(50),
  USR /* TYPE OF COLUMN PARAMS.USR */ VARCHAR(15))
AS
BEGIN
  SUSPEND;
END
^

SET TERM ; ^

CREATE DOMAIN DPARAMSVAL AS VARCHAR(250);


ALTER TABLE PARAMS ALTER COLUMN PVALUE TYPE DPARAMSVAL;

SET TERM ^ ;

ALTER PROCEDURE SP_PARAMS(
  USERNAME VARCHAR(20))
RETURNS (
  ID TYPE OF COLUMN PARAMS.ID,
  PNAME TYPE OF COLUMN PARAMS.PNAME,
  PVALUE TYPE OF COLUMN PARAMS.PVALUE,
  USR TYPE OF COLUMN PARAMS.USR)
AS
begin
    FOR SELECT id, pname, pvalue, usr
    FROM PARAMS
    WHERE PARAMS.Usr = 'SYSTEM' OR PARAMS.Usr = :username
    ORDER BY PARAMS.PName
    INTO :id, :pname, :pvalue, :usr
    do
    begin
        suspend;
    end
end
^

SET TERM ; ^

INSERT INTO Params (PNAME, USR) VALUES ('EINVOICEFOLDER', 'SYSTEM');
INSERT INTO Params (PNAME, USR) VALUES ('EIEMAIL', 'SYSTEM');
INSERT INTO Params (PNAME, USR) VALUES ('EIEMAILPSW', 'SYSTEM');
INSERT INTO Params (PNAME, USR) VALUES ('EIEMAILSERVER', 'SYSTEM');
INSERT INTO Params (PNAME, USR) VALUES ('EIEMAILSERVERPORT', 'SYSTEM');

UPDATE Params
SET PVALUE = '027'
WHERE PNAME = 'version';
